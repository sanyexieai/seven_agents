# 商汤科技新闻分析示例

本示例展示了如何通过两个智能体使用A2A MCP和RAG技术，实现从谷歌新闻搜索商汤科技新闻数据并生成财报分析报告。

## 示例概述

### 技术栈
- **A2A (Agent-to-Agent)**: 智能体间通信协议
- **MCP (Model Context Protocol)**: 模型上下文协议，用于工具调用
- **RAG (Retrieval-Augmented Generation)**: 检索增强生成
- **Google News搜索**: 真实的新闻数据获取
- **智能体协作**: 两个专业智能体的分工协作

### 智能体分工

#### 1. 新闻收集智能体 (NewsCollectorAgent)
- **职责**: 搜索和收集商汤科技相关新闻
- **工具**: MCP WebSearchTool (Google News搜索)
- **功能**:
  - 使用多个关键词搜索最新新闻
  - 数据清理和预处理
  - 存储到RAG知识库
  - 生成数据摘要

#### 2. 财报生成智能体 (ReportGeneratorAgent)
- **职责**: 分析新闻数据并生成财报报告
- **工具**: RAG知识库、数据分析工具
- **功能**:
  - 从RAG知识库检索相关新闻
  - 多维度数据分析（业务、财务、市场、风险）
  - 生成专业的财报分析报告
  - 保存报告到本地文件

## 文件说明

### 主要文件
- `shangtang_news_analysis_example.py`: 完整的A2A智能体协作示例
- `test_mcp_google_news.py`: 专门测试MCP Google News搜索功能
- `README_shangtang_example.md`: 本说明文档

### 输出文件
- `reports/shangtang_report_*.md`: 生成的财报分析报告
- `reports/shangtang_mcp_test_report_*.md`: 测试报告

## 使用方法

### 1. 运行完整示例
```bash
cd examples
python shangtang_news_analysis_example.py
```

### 2. 运行MCP测试
```bash
cd examples
python test_mcp_google_news.py
```

## 工作流程

### 第一阶段：新闻数据收集
1. 新闻收集智能体使用MCP工具调用Google News搜索
2. 搜索关键词包括：
   - "商汤科技 最新消息"
   - "SenseTime 新闻"
   - "商汤科技 AI技术"
   - "商汤科技 财报"
   - "商汤科技 市场表现"
   - "商汤科技 合作伙伴"
   - "商汤科技 技术突破"
3. 对搜索结果进行清理和预处理
4. 将处理后的数据存储到RAG知识库

### 第二阶段：数据验证和准备
1. 验证收集到的新闻数据质量
2. 生成数据摘要和统计信息
3. 准备数据传递给财报生成智能体

### 第三阶段：财报分析生成
1. 财报生成智能体从RAG知识库检索相关新闻
2. 进行多维度数据分析：
   - 业务发展分析
   - 财务状况评估
   - 市场表现分析
   - 风险评估
3. 生成专业的财报分析报告
4. 保存报告到本地Markdown文件

## 技术特点

### MCP工具集成
- 使用真实的Google News搜索API
- 支持日期范围过滤
- 自动处理搜索结果格式
- 错误处理和重试机制

### RAG知识库
- 向量化存储新闻数据
- 语义搜索功能
- 元数据管理
- 知识库统计

### 智能体协作
- 异步任务执行
- 数据传递和验证
- 错误处理和恢复
- 工作流程监控

### 报告生成
- 结构化的财报分析
- 多维度数据展示
- 专业的投资建议
- 风险提示和免责声明

## 配置要求

### 环境变量
```env
# LLM配置
OPENAI_API_KEY=your_openai_api_key
OPENAI_BASE_URL=https://api.openai.com/v1

# 其他配置
LOG_LEVEL=INFO
```

### 依赖包
```bash
pip install -r requirements.txt
```

## 注意事项

### 网络搜索限制
- Google News搜索有频率限制，建议适当延迟
- 可能需要处理验证码或IP限制
- 建议在测试环境中使用

### 数据质量
- 新闻数据的准确性和时效性
- 来源的可信度评估
- 内容的客观性分析

### 法律合规
- 遵守相关法律法规
- 注意版权和知识产权
- 合理使用公开数据

## 扩展功能

### 可能的改进
1. **多数据源集成**: 添加其他新闻源（如百度新闻、新浪财经等）
2. **情感分析**: 集成更复杂的情感分析模型
3. **实时监控**: 实现新闻数据的实时监控和更新
4. **可视化**: 添加图表和可视化展示
5. **多公司支持**: 扩展到其他公司的新闻分析

### 技术优化
1. **缓存机制**: 实现搜索结果缓存
2. **并发处理**: 优化多关键词并发搜索
3. **数据持久化**: 改进数据存储方案
4. **API优化**: 优化MCP工具调用效率

## 故障排除

### 常见问题
1. **搜索失败**: 检查网络连接和API限制
2. **数据解析错误**: 检查Google News页面结构变化
3. **RAG存储失败**: 检查文件权限和磁盘空间
4. **报告生成失败**: 检查LLM API配置

### 调试方法
1. 查看详细日志输出
2. 检查中间数据文件
3. 验证API密钥和配置
4. 测试单个组件功能

## 总结

本示例成功展示了：
- ✅ 通过MCP工具调用真实的Google News搜索
- ✅ 使用RAG技术进行知识存储和检索
- ✅ 实现两个智能体的A2A协作
- ✅ 生成专业的财报分析报告
- ✅ 完整的错误处理和工作流程管理

这是一个完整的端到端示例，展示了现代AI系统中智能体协作、工具调用和知识管理的实际应用。 